(()=>{"use strict";var __webpack_modules__={91:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.adminConfigurationFactory=void 0;const tslib_1=__webpack_require__(752),PlatformAdmin_1=__webpack_require__(424),CountryAdmin_1=__webpack_require__(845),PartnerAdmin_1=__webpack_require__(48),PublicationAdmin_1=__webpack_require__(295);exports.adminConfigurationFactory=configService=>({adminJsOptions:{rootPath:"/admin",resources:[PlatformAdmin_1.PlatformAdmin,CountryAdmin_1.CountryAdmin,PartnerAdmin_1.PartnerAdmin,PublicationAdmin_1.PublicationAdmin],locale:{language:"en",translations:{labels:{Platform:"Platform (Teams)"},resources:{Platform:{properties:{countryId:"Country"}}}}},branding:{companyName:"InfluenzaNet",logo:"/public/influenzanet_logo.png"},assets:{styles:["/public/css/admin.css"]}},auth:{authenticate:(email,password)=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){const adminUser=configService.get("ADMIN_USER","admin"),adminPassword=configService.get("ADMIN_PASSWORD","password");return email===adminUser&&password===adminPassword?Promise.resolve({email:adminUser,password:adminPassword}):null})),cookieName:"influenzaNet-AuthToken",cookiePassword:"testPass"},sessionOptions:{resave:!0,saveUninitialized:!0,secret:"secret"}})},845:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.CountryAdmin=void 0;const Country_1=__webpack_require__(282);exports.CountryAdmin={resource:Country_1.Country,options:{properties:{id:{isVisible:!1},name:{type:"string"}},actions:{show:{isAccessible:!1},edit:{showInDrawer:!0}},navigation:{icon:"EarthFilled"}}}},48:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PartnerAdmin=void 0;const Partner_1=__webpack_require__(14);exports.PartnerAdmin={resource:Partner_1.Partner,options:{properties:{id:{isVisible:!1},name:{type:"string",isTitle:!0,position:1},website:{type:"string",position:2},description:{type:"richtext",content:"Changed label",position:1e3,description:""},actions:{show:{isAccessible:!1}}},navigation:{icon:"Partnership"}}}},424:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformAdmin=void 0;const Platform_1=__webpack_require__(45);exports.PlatformAdmin={resource:Platform_1.Platform,options:{properties:{id:{isVisible:!1},name:{type:"string",isTitle:!0,position:1},countryId:{position:2},website:{type:"string",position:3},order:{type:"number",position:3},description:{type:"richtext",content:"Changed label",position:1e3,description:""},logo:{type:"string",isVisible:!0}},actions:{show:{isAccessible:!1}},sort:{sortBy:"order",direction:"asc"},navigation:{icon:"Webhook"}}}},295:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PublicationAdmin=void 0;const tslib_1=__webpack_require__(752),Publication_1=__webpack_require__(170);exports.PublicationAdmin={resource:Publication_1.Publication,options:{properties:{id:{isVisible:!1},title:{type:"string"},authors:{type:"string"},publisher:{type:"string"},publicationDate:{type:"date"},url:{type:"string"}},actions:{show:{isAccessible:!1},edit:{showInDrawer:!0},new:{showInDrawer:!0},list:{before:(request,context)=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){return request.query.perPage=20,request}))}},sort:{sortBy:"publicationDate",direction:"desc"},navigation:{icon:"Book"}}}},923:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppController=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481);let AppController=class AppController{constructor(){}};AppController=tslib_1.__decorate([(0,common_1.Controller)(),tslib_1.__metadata("design:paramtypes",[])],AppController),exports.AppController=AppController},573:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),app_controller_1=__webpack_require__(923),typeorm_1=__webpack_require__(399),nestjs_1=__webpack_require__(71),AdminJSTypeorm=__webpack_require__(634),adminjs_1=__webpack_require__(975),serve_static_1=__webpack_require__(385),platform_module_1=__webpack_require__(825),publication_module_1=__webpack_require__(774),configuration_1=__webpack_require__(91),path_1=__webpack_require__(17),config_1=__webpack_require__(793),database_1=__webpack_require__(267);adminjs_1.default.registerAdapter({Resource:AdminJSTypeorm.Resource,Database:AdminJSTypeorm.Database});let AppModule=class AppModule{};AppModule=tslib_1.__decorate([(0,common_1.Module)({imports:[config_1.ConfigModule.forRoot({ignoreEnvFile:!0,isGlobal:!0}),serve_static_1.ServeStaticModule.forRoot({rootPath:(0,path_1.resolve)(__dirname,"assets"),serveRoot:"/public/"}),typeorm_1.TypeOrmModule.forRootAsync({imports:[config_1.ConfigModule],inject:[config_1.ConfigService],useFactory:database_1.databaseConfigurationFactory}),nestjs_1.AdminModule.createAdminAsync({imports:[config_1.ConfigModule],inject:[config_1.ConfigService],useFactory:configuration_1.adminConfigurationFactory}),platform_module_1.PlatformModule,publication_module_1.PublicationModule],controllers:[app_controller_1.AppController],providers:[]})],AppModule),exports.AppModule=AppModule},185:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformController=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),Platform_1=__webpack_require__(45),typeorm_1=__webpack_require__(399),typeorm_2=__webpack_require__(250);let PlatformController=class PlatformController{constructor(platform){this.platform=platform}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.platform.find({relations:["country"]})}))}};tslib_1.__decorate([(0,common_1.Get)("/"),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],PlatformController.prototype,"findAll",null),PlatformController=tslib_1.__decorate([(0,common_1.Controller)("platform"),tslib_1.__param(0,(0,typeorm_1.InjectRepository)(Platform_1.Platform)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==typeorm_2.Repository&&typeorm_2.Repository)?_a:Object])],PlatformController),exports.PlatformController=PlatformController},825:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),typeorm_1=__webpack_require__(399),Platform_1=__webpack_require__(45),platform_controller_1=__webpack_require__(185);let PlatformModule=class PlatformModule{};PlatformModule=tslib_1.__decorate([(0,common_1.Module)({imports:[typeorm_1.TypeOrmModule.forFeature([Platform_1.Platform])],controllers:[platform_controller_1.PlatformController]})],PlatformModule),exports.PlatformModule=PlatformModule},745:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PublicationController=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),typeorm_1=__webpack_require__(399),typeorm_2=__webpack_require__(250),Publication_1=__webpack_require__(170);let PublicationController=class PublicationController{constructor(publication){this.publication=publication}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.publication.find({})}))}};tslib_1.__decorate([(0,common_1.Get)("/"),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],PublicationController.prototype,"findAll",null),PublicationController=tslib_1.__decorate([(0,common_1.Controller)("publication"),tslib_1.__param(0,(0,typeorm_1.InjectRepository)(Publication_1.Publication)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==typeorm_2.Repository&&typeorm_2.Repository)?_a:Object])],PublicationController),exports.PublicationController=PublicationController},774:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PublicationModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),typeorm_1=__webpack_require__(399),Publication_1=__webpack_require__(170),publication_controller_1=__webpack_require__(745);let PublicationModule=class PublicationModule{};PublicationModule=tslib_1.__decorate([(0,common_1.Module)({imports:[typeorm_1.TypeOrmModule.forFeature([Publication_1.Publication])],controllers:[publication_controller_1.PublicationController]})],PublicationModule),exports.PublicationModule=PublicationModule},267:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.databaseConfigurationFactory=void 0;const Platform_1=__webpack_require__(45),Country_1=__webpack_require__(282),Partner_1=__webpack_require__(14),Publication_1=__webpack_require__(170);exports.databaseConfigurationFactory=configService=>({type:"mysql",host:configService.get("MYSQL_HOST","mysql"),port:configService.get("MYSQL_PORT",3306),database:configService.get("MYSQL_DATABASE","influenzanet"),username:configService.get("MYSQL_USER","user"),password:configService.get("MYSQL_PASSWORD","password"),extra:{charset:"utf8mb4_unicode_ci"},entities:[Platform_1.Platform,Country_1.Country,Partner_1.Partner,Publication_1.Publication],autoLoadEntities:!1,synchronize:!1})},282:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Country=void 0;const tslib_1=__webpack_require__(752),typeorm_1=__webpack_require__(250);let Country=class Country extends typeorm_1.BaseEntity{constructor(data){super(),Object.assign(this,data)}};tslib_1.__decorate([(0,typeorm_1.PrimaryGeneratedColumn)(),tslib_1.__metadata("design:type",Number)],Country.prototype,"id",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Country.prototype,"name",void 0),tslib_1.__decorate([(0,typeorm_1.OneToMany)("platform","country"),tslib_1.__metadata("design:type","function"==typeof(_b="undefined"!=typeof Array&&Array)?_b:Object)],Country.prototype,"platforms",void 0),Country=tslib_1.__decorate([(0,typeorm_1.Entity)({name:"country"}),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a="undefined"!=typeof Partial&&Partial)?_a:Object])],Country),exports.Country=Country},14:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Partner=void 0;const tslib_1=__webpack_require__(752),typeorm_1=__webpack_require__(250),Platform_1=__webpack_require__(45);let Partner=class Partner extends typeorm_1.BaseEntity{constructor(id,name,logo,website,description,platform){super(),this.id=id,this.name=name,this.logo=logo,this.website=website,this.description=description,this.platform=platform}};tslib_1.__decorate([(0,typeorm_1.PrimaryGeneratedColumn)(),tslib_1.__metadata("design:type",Number)],Partner.prototype,"id",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Partner.prototype,"name",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Partner.prototype,"logo",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Partner.prototype,"website",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Partner.prototype,"description",void 0),tslib_1.__decorate([(0,typeorm_1.ManyToMany)((()=>Platform_1.Platform)),(0,typeorm_1.JoinTable)(),tslib_1.__metadata("design:type",Array)],Partner.prototype,"platform",void 0),Partner=tslib_1.__decorate([(0,typeorm_1.Entity)({name:"partner"}),tslib_1.__metadata("design:paramtypes",[Number,String,String,String,String,Array])],Partner),exports.Partner=Partner},45:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphData=exports.GraphDataFeatureIndexed=exports.GraphDataFeature=exports.Platform=void 0;const tslib_1=__webpack_require__(752),typeorm_1=__webpack_require__(250),Country_1=__webpack_require__(282),Partner_1=__webpack_require__(14),PlatformData_1=__webpack_require__(73);let Platform=class Platform extends typeorm_1.BaseEntity{constructor(id,name,description,website,filePrefix,country,countryId,partner,data,logo){super(),this.id=id,this.name=name,this.description=description,this.website=website,this.filePrefix=filePrefix,this.country=country,this.countryId=countryId,this.partner=partner,this.data=data,this.logo=logo,this.graphData=this.graphData||new GraphData}};tslib_1.__decorate([(0,typeorm_1.PrimaryGeneratedColumn)(),tslib_1.__metadata("design:type",Number)],Platform.prototype,"id",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Platform.prototype,"name",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Platform.prototype,"description",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Platform.prototype,"website",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Platform.prototype,"filePrefix",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({default:!0}),tslib_1.__metadata("design:type",Boolean)],Platform.prototype,"active",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({default:100,nullable:!0}),tslib_1.__metadata("design:type",Number)],Platform.prototype,"order",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Platform.prototype,"logo",void 0),tslib_1.__decorate([(0,typeorm_1.ManyToOne)("country","platforms"),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==Country_1.Country&&Country_1.Country)?_c:Object)],Platform.prototype,"country",void 0),tslib_1.__decorate([(0,typeorm_1.RelationId)((platform=>platform.country)),(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",Number)],Platform.prototype,"countryId",void 0),tslib_1.__decorate([(0,typeorm_1.ManyToMany)((()=>Partner_1.Partner)),tslib_1.__metadata("design:type",Array)],Platform.prototype,"partner",void 0),Platform=tslib_1.__decorate([(0,typeorm_1.Entity)({name:"platform"}),tslib_1.__metadata("design:paramtypes",[Number,String,String,String,String,"function"==typeof(_a=void 0!==Country_1.Country&&Country_1.Country)?_a:Object,Number,Array,"function"==typeof(_b=void 0!==PlatformData_1.PlatformData&&PlatformData_1.PlatformData)?_b:Object,String])],Platform),exports.Platform=Platform;exports.GraphDataFeature=class GraphDataFeature{constructor(data){data&&Object.assign(this,data),this.rows=this.rows||[]}};class GraphDataFeatureIndexed{}exports.GraphDataFeatureIndexed=GraphDataFeatureIndexed;class GraphData{constructor(data){data&&Object.assign(this,data),this.active=this.active||new GraphDataFeatureIndexed,this.incidence=this.incidence||new GraphDataFeatureIndexed,this.visits_cumulated=this.visits_cumulated||new GraphDataFeatureIndexed}}exports.GraphData=GraphData},73:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformDataVisitsCumulated=exports.PlatformDataIncidence=exports.PlatformDataActive=exports.PlatformData=exports.PlatformFeature=void 0;const moment=__webpack_require__(245);class PlatformFeature{constructor(data){(null==data?void 0:data.yw)&&(this.week=Number(data.yw.toString().slice(-2)),this.year=Number(data.yw.toString().slice(0,4)),this.month=moment().day("Monday").year(this.year).isoWeek(this.week).toDate().getMonth(),this.isFirstOfMonth=moment().year(this.year).month(this.month).startOf("month").isoWeekday(8).isoWeek()===this.week),data.dataType&&(this.dataType=data.dataType)}}exports.PlatformFeature=PlatformFeature;exports.PlatformData=class PlatformData{constructor(data){Object.assign(this,data)}};exports.PlatformDataActive=class PlatformDataActive extends PlatformFeature{constructor(data){super(data),Object.assign(this,data),this.value=this.value||this.active}};exports.PlatformDataIncidence=class PlatformDataIncidence extends PlatformFeature{constructor(data){super(data),Object.assign(this,data),this.min=1e3*this.lower,this.value=1e3*this.incidence,this.max=1e3*this.upper}};exports.PlatformDataVisitsCumulated=class PlatformDataVisitsCumulated extends PlatformFeature{constructor(data){super(data),Object.assign(this,data),this.min=100*this.cum_prop_adj_low,this.value=100*this.cum_prop_adj,this.max=100*this.cum_prop_adj_up}}},170:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Publication=void 0;const tslib_1=__webpack_require__(752),typeorm_1=__webpack_require__(250);let Publication=class Publication extends typeorm_1.BaseEntity{constructor(id,title,authors){super(),this.id=id,this.title=title,this.authors=authors}};tslib_1.__decorate([(0,typeorm_1.PrimaryGeneratedColumn)(),tslib_1.__metadata("design:type",Number)],Publication.prototype,"id",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Publication.prototype,"title",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({type:"varchar",length:200}),tslib_1.__metadata("design:type",String)],Publication.prototype,"authors",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Publication.prototype,"publisher",void 0),tslib_1.__decorate([(0,typeorm_1.Column)(),tslib_1.__metadata("design:type",String)],Publication.prototype,"publicationDate",void 0),tslib_1.__decorate([(0,typeorm_1.Column)({nullable:!0}),tslib_1.__metadata("design:type",String)],Publication.prototype,"url",void 0),Publication=tslib_1.__decorate([(0,typeorm_1.Entity)({name:"publication"}),tslib_1.__metadata("design:paramtypes",[Number,String,String])],Publication),exports.Publication=Publication},71:module=>{module.exports=require("@adminjs/nestjs")},634:module=>{module.exports=require("@adminjs/typeorm")},481:module=>{module.exports=require("@nestjs/common")},793:module=>{module.exports=require("@nestjs/config")},143:module=>{module.exports=require("@nestjs/core")},385:module=>{module.exports=require("@nestjs/serve-static")},399:module=>{module.exports=require("@nestjs/typeorm")},975:module=>{module.exports=require("adminjs")},245:module=>{module.exports=require("moment")},752:module=>{module.exports=require("tslib")},250:module=>{module.exports=require("typeorm")},17:module=>{module.exports=require("path")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752),common_1=__webpack_require__(481),core_1=__webpack_require__(143),app_module_1=__webpack_require__(573);!function(){tslib_1.__awaiter(this,void 0,void 0,(function*(){const app=yield core_1.NestFactory.create(app_module_1.AppModule,{cors:!0});app.setGlobalPrefix("api");const port={NODE_ENV:"production",NX_CLI_SET:"true",NX_LOAD_DOT_ENV_FILES:"true",NX_WORKSPACE_ROOT:"/app",NX_SKIP_NX_CACHE:"true",NX_TERMINAL_OUTPUT_PATH:"/app/node_modules/.cache/nx/terminalOutputs/71139fdeca07723e28f5cf3a918be06bdb91b75be84961915e6b806e7475a66f",NX_TASK_TARGET_PROJECT:"server",NX_TASK_HASH:"71139fdeca07723e28f5cf3a918be06bdb91b75be84961915e6b806e7475a66f"}.PORT||3333;yield app.listen(port),common_1.Logger.log(`🚀 Application is running on: http://localhost:${port}/api`)}))}()})();var __webpack_export_target__=exports;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map